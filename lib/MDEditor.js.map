{"version":3,"sources":["../src/MDEditor.js"],"names":[],"mappings":"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","file":"MDEditor.js","sourcesContent":["import React, { PropTypes } from 'react'\nimport _ from 'lodash'\nimport styles from './styles'\nimport Tools from './components/tools/Tools'\nimport EditBox from './components/EditBox'\nimport PreviewBox from './components/PreviewBox'\nimport Marked from './utils/markFn'\n\nconst Tabs = {\n  edit: '编辑',\n  preview: '预览',\n}\n\nclass MDEditor extends React.Component {\n  state = {\n    focus: false,\n    selectedPosition: {\n      start: 0,\n      end: 0,\n    },\n    scale: 'normal',\n  }\n  setFocus = (focus) => this.setState({ focus })\n  setSelectedPosition = (selectedPosition) => this.setState({ selectedPosition })\n  setScale = (scale) => this.setState({ scale })\n  format = (before, after) => {\n    const { selectedPosition } = this.state\n    const { value, onValueChange } = this.props\n    let firstPart = value.substring(0, selectedPosition.start)\n    const selectPart = value.substring(selectedPosition.start, selectedPosition.end)\n    let lastPart = value.substring(selectedPosition.end)\n    if (firstPart.substring(firstPart.length - before.length) === before &&\n    lastPart.substring(0, after.length) === after) {\n      firstPart = firstPart.substring(0, firstPart.length - before.length)\n      lastPart = lastPart.substring(after.length)\n    } else {\n      firstPart += before\n      lastPart = after + lastPart\n    }\n    onValueChange(firstPart + selectPart + lastPart)\n    this.setSelectedPosition({\n      start: firstPart.length,\n      end: firstPart.length + selectPart.length,\n    })\n  }\n  render() {\n    const { tab, onTabChange, value, onValueChange, markFn, imageUpload, minHeight } = this.props\n    const { focus, selectedPosition, scale } = this.state\n    let editBoxStyle = minHeight ? { minHeight: `${minHeight}px` } : {}\n    let previewBoxStyle = {}\n    if (tab === 'edit' && scale === 'normal') {\n      previewBoxStyle = { display: 'none' }\n    }\n    if (tab === 'edit' && scale === 'full') {\n      editBoxStyle = { width: '50%' }\n      previewBoxStyle = { position: 'absolute', width: '50%', left: '50%', top: 0 }\n    }\n    if (tab === 'preview') {\n      editBoxStyle = { display: 'none' }\n    }\n    return (\n      <div style={_.merge({}, styles.stage, styles[scale])}>\n        <div style={styles.controlPanel}>\n          <div style={styles.togglePanel}>\n            {\n              _.map(Tabs, (t, k) => (\n                <span\n                  key={k}\n                  style={_.merge({}, styles.toggleTab, tab === k && styles.selectedTab)}\n                  onClick={() => onTabChange(k)}\n                >\n                  {t}\n                </span>\n              ))\n            }\n            <div style={{ flex: 1 }} />\n            <Tools\n              format={this.format}\n              styles={styles}\n              scale={scale}\n              setScale={this.setScale}\n            />\n          </div>\n        </div>\n        <div style={styles.contentBox}>\n          <EditBox\n            value={value}\n            focus={focus}\n            onChange={onValueChange}\n            onBlur={() => this.setFocus(false)}\n            onFocus={() => this.setFocus(true)}\n            styles={styles}\n            style={editBoxStyle}\n            selectedPosition={selectedPosition}\n            setSelectedPosition={this.setSelectedPosition}\n            format={this.format}\n            imageUpload={imageUpload}\n          />\n          <PreviewBox\n            styles={styles}\n            style={previewBoxStyle}\n            html={markFn(value)}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nMDEditor.defaultProps = {\n  markFn: Marked,\n}\n\nMDEditor.propTypes = {\n  value: PropTypes.string.isRequired,\n  tab: PropTypes.oneOf(_.keys(Tabs)).isRequired,\n  onValueChange: PropTypes.func.isRequired,\n  onTabChange: PropTypes.func.isRequired,\n  markFn: PropTypes.func,\n  imageUpload: PropTypes.func,\n  minHeight: PropTypes.number,\n}\nexport default MDEditor\n"]}